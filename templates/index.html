<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>NLP Humanizer — Detect → Rewrite → Retest</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <style>
        body { font-family: Arial, sans-serif; background:#0f1115; color:#eaeaea; }
.container { max-width: 980px; margin: 30px auto; padding: 0 14px; }
textarea { width:100%; padding:12px; border-radius:10px; border:1px solid #2a2f3a; background:#151923; color:#eaeaea; }
button { margin-top:10px; padding:10px 14px; border-radius:10px; border:none; background:#3b82f6; color:white; cursor:pointer; }
button:hover { opacity:0.92; }
hr { border:0; border-top:1px solid #2a2f3a; margin:22px 0; }
.grid { display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
.card { background:#151923; border:1px solid #2a2f3a; border-radius:14px; padding:12px; }
.note { color:#b8c0cc; }
.checks { margin:10px 0; display:flex; gap:18px; flex-wrap:wrap; }
pre { white-space: pre-wrap; }
    </style>
  <div class="container">
    <h1>Detect → Rewrite → Retest</h1>
    <p class="note">
      Educational demo: evaluates style using your own detectors and shows changes transparently.
    </p>

    <form method="POST">
      <label>Paste text:</label>
      <textarea name="text" rows="10" placeholder="Paste your text here...">{{ result.original if result else "" }}</textarea>

      <div class="checks">
        <label><input type="checkbox" name="goal_human" checked> Humanize (AI → Human)</label>
        <label><input type="checkbox" name="goal_informal" checked> Make slightly informal</label>
      </div>

      <button type="submit">Analyze + Rewrite</button>
    </form>

    {% if result %}
      <hr/>

      <h2>Before</h2>
      <div class="grid">
        <div class="card">
          <h3>AI vs Human</h3>
          <p><b>Label:</b> {{ result.before_ai.label }} ({{ '%.3f'|format(result.before_ai.confidence) }})</p>
          <p><b>Top markers:</b></p>
          <ul>
            {% for f in result.before_ai.top_features %}
              <li>{{ f.feature }} ({{ '%.4f'|format(f.contribution) }})</li>
            {% endfor %}
          </ul>
        </div>

        <div class="card">
          <h3>Formality</h3>
          <p><b>Label:</b> {{ result.before_form.label }} ({{ '%.3f'|format(result.before_form.confidence) }})</p>
          <p><b>Top markers:</b></p>
          <ul>
            {% for f in result.before_form.top_features %}
              <li>{{ f.feature }} ({{ '%.4f'|format(f.contribution) }})</li>
            {% endfor %}
          </ul>
        </div>
      </div>

      <h2>Rewrite</h2>
      <textarea rows="10" readonly>{{ result.rewritten }}</textarea>

      <h2>After</h2>
      <div class="grid">
        <div class="card">
          <h3>AI vs Human</h3>
          <p><b>Label:</b> {{ result.after_ai.label }} ({{ '%.3f'|format(result.after_ai.confidence) }})</p>
        </div>
        <div class="card">
          <h3>Formality</h3>
          <p><b>Label:</b> {{ result.after_form.label }} ({{ '%.3f'|format(result.after_form.confidence) }})</p>
        </div>
      </div>

      <p><b>Meaning similarity (embeddings):</b> {{ '%.3f'|format(result.similarity) }}</p>

      <h2>Explanation</h2>
      <div class="card">
        <pre>{{ result.explanation }}</pre>
      </div>
    {% endif %}
  </div>
</body>
</html>
